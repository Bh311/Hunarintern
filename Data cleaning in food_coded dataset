import pandas as pd
import numpy as np

# Load the dataset
dataset_path = 'path_to_your_dataset.csv'
df = pd.read_csv(dataset_path)

# Check for missing values
missing_values = df.isnull().sum()
print('Missing values in each column:')
print(missing_values)

# Fill numeric columns with the mean
numeric_columns = df.select_dtypes(include=[np.number]).columns
df[numeric_columns] = df[numeric_columns].fillna(df[numeric_columns].mean())

# Fill categorical columns with the mode
categorical_columns = df.select_dtypes(include=[object]).columns
for column in categorical_columns:
    df[column] = df[column].fillna(df[column].mode()[0])

# Check for duplicates
duplicates = df.duplicated().sum()
print(f'Number of duplicate rows: {duplicates}')

# Remove duplicates
df = df.drop_duplicates()

# Save the cleaned dataset to a new CSV file
cleaned_dataset_path = 'cleaned_dataset.csv'
df.to_csv(cleaned_dataset_path, index=False)

print('Data cleaning complete. Cleaned dataset saved as cleaned_dataset.csv.')
